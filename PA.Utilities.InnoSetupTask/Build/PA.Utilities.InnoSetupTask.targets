<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<PropertyGroup>
		<SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">$(MSBuildProjectDirectory)\..\</SolutionDir>
		<IntermediateOutputPath Condition="$(IntermediateOutputPath) == '' Or $(IntermediateOutputPath) == '*Undefined*'">$(MSBuildProjectDirectory)\obj\$(Configuration)\</IntermediateOutputPath>
		<InnoSetupTaskPath Condition="$(InnoSetupTaskPath) == '' Or $(InnoSetupTaskPath) == '*Undefined*'">$(MSBuildThisFileDirectory)..\</InnoSetupTaskPath>
	</PropertyGroup>
	<UsingTask TaskName="InnoSetupTask.PreprocessInnoSetupScript" AssemblyFile="$(InnoSetupTaskPath)PA.Utilities.InnoSetupTask.dll" />
	<UsingTask TaskName="InnoSetupTask.UpdateFileList" AssemblyFile="$(InnoSetupTaskPath)PA.Utilities.InnoSetupTask.dll" />
	<ItemGroup>
		<InnoSetupScripts Include="*.iss" />
	</ItemGroup>
	<ItemGroup>
		<InnoSetupExtraCode Include="$(InnoSetupTaskPath)**\*.iss" />
	</ItemGroup>
	<Target Name="PreprocessInnoSetupScript" BeforeTargets="CoreCompile" Inputs="@(InnoSetupScripts)" Outputs="@(InnoSetupScripts-&gt;'$(MSBuildProjectDirectory)\$(IntermediateOutputPath)%(Filename)%(Extension)')">
		<Message Importance="High" Text="Working in $(InnoSetupTaskPath)" />
		<Message Importance="High" Text="Update following scripts: @(InnoSetupScripts)" />
		<Message Importance="High" Text="Update following code: @(InnoSetupExtraCode)" />
		<PreprocessInnoSetupScript ProjectFile="$(MSBuildProjectFullPath)" Scripts="@(InnoSetupScripts)" ExtraCode="@(InnoSetupExtraCode)" IntermediateOutputPath="$(IntermediateOutputPath)" DestinationFolder="$(OutputPath)" />
	</Target>
	<Target Name="CleanInnoSetupScripts" AfterTargets="CoreClean">
		<Message Importance="High" Text="Clean following scripts: @(InnoSetupScripts-&gt;'$(MSBuildProjectDirectory)\$(IntermediateOutputPath)%(Filename)%(Extension)')" />
		<Delete Files="@(InnoSetupScripts-&gt;'$(MSBuildProjectDirectory)\$(IntermediateOutputPath)%(Filename)%(Extension)')" />
	</Target>
	<!--Support for ncrunch-->
	<ItemGroup Condition=" $(NCrunch) != '' ">
		<None Include="$(InnoSetupTaskDir)PA.Utilities.InnoSetupTask.dll">
			<Visible>False</Visible>
		</None>
		<None Include="$(InnoSetupTaskDir)PA.Utilities.InnoSetupTask.pdb">
			<Visible>False</Visible>
		</None>
		<None Include="$(InnoSetupTaskDir)NativeBinaries\**\*">
			<Visible>False</Visible>
		</None>
	</ItemGroup>
</Project>